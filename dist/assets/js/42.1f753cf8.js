(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{347:function(t,s,a){"use strict";a.r(s);var n=a(3),r=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"vue-1"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#vue-1"}},[t._v("#")]),t._v(" Vue(1)")]),t._v(" "),s("p"),s("div",{staticClass:"table-of-contents"},[s("ul",[s("li",[s("a",{attrs:{href:"#_1-es6模块化"}},[t._v("1. ES6模块化")]),s("ul",[s("li",[s("a",{attrs:{href:"#_1-1-前端模块化规范的分类"}},[t._v("1.1. 前端模块化规范的分类")])]),s("li",[s("a",{attrs:{href:"#_1-2-什么是es6模块化规范"}},[t._v("1.2. 什么是ES6模块化规范")])]),s("li",[s("a",{attrs:{href:"#_1-3-在node-js中体验es6模块化"}},[t._v("1.3. 在node.js中体验ES6模块化")])]),s("li",[s("a",{attrs:{href:"#_1-4-es6模块化的基本语法"}},[t._v("1.4. ES6模块化的基本语法")])])])]),s("li",[s("a",{attrs:{href:"#_2-promise"}},[t._v("2. Promise")]),s("ul",[s("li",[s("a",{attrs:{href:"#_2-1-回调地狱"}},[t._v("2.1 回调地狱")])]),s("li",[s("a",{attrs:{href:"#_2-2-promise的基本概念"}},[t._v("2.2 Promise的基本概念")])]),s("li",[s("a",{attrs:{href:"#_2-3-then-fs的基本使用"}},[t._v("2.3 then-fs的基本使用")])]),s("li",[s("a",{attrs:{href:"#_2-4-基于promise按顺序读取文件的内容"}},[t._v("2.4 基于Promise按顺序读取文件的内容")])]),s("li",[s("a",{attrs:{href:"#_2-5-通过-catch捕获错误"}},[t._v("2.5 通过.catch捕获错误")])]),s("li",[s("a",{attrs:{href:"#_2-6-promise-all-方法"}},[t._v("2.6 Promise.all()方法")])])])]),s("li",[s("a",{attrs:{href:"#_3-async-await"}},[t._v("3. async / await")]),s("ul",[s("li",[s("a",{attrs:{href:"#_3-1-async-await的基本使用"}},[t._v("3.1 async/await的基本使用")])]),s("li",[s("a",{attrs:{href:"#_3-2-async-await的使用注意事项"}},[t._v("3.2 async/await的使用注意事项")])])])]),s("li",[s("a",{attrs:{href:"#_4-eventloop"}},[t._v("4. EventLoop")]),s("ul",[s("li",[s("a",{attrs:{href:"#_4-1-同步任务和异步任务"}},[t._v("4.1 同步任务和异步任务")])]),s("li",[s("a",{attrs:{href:"#_4-2-同步任务和异步任务的执行过程"}},[t._v("4.2 同步任务和异步任务的执行过程")])]),s("li",[s("a",{attrs:{href:"#_4-3-eventloop的基本概念"}},[t._v("4.3 EventLoop的基本概念")])]),s("li",[s("a",{attrs:{href:"#_4-4-宏任务与微任务"}},[t._v("4.4 宏任务与微任务")])])])])])]),s("p"),t._v(" "),s("h2",{attrs:{id:"_1-es6模块化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-es6模块化"}},[t._v("#")]),t._v(" 1. ES6模块化")]),t._v(" "),s("h3",{attrs:{id:"_1-1-前端模块化规范的分类"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-前端模块化规范的分类"}},[t._v("#")]),t._v(" 1.1. 前端模块化规范的分类")]),t._v(" "),s("p",[t._v("在"),s("strong",[t._v("ES6模块化规范")]),t._v("诞生之前， JavaScript社区已经尝试并提出了"),s("strong",[t._v("AMD、CMD、CommonJS")]),t._v("等模块化规范。但是，这些由社区提出的模块化标准，还是存在一定的"),s("strong",[t._v("差异性")]),t._v("与"),s("strong",[t._v("局限性")]),t._v("、"),s("strong",[t._v("并不是")]),t._v("浏览器与服务器"),s("strong",[t._v("通用的模块化标准")]),t._v("，例如：")]),t._v(" "),s("ul",[s("li",[t._v("AMD和CMD适用于"),s("strong",[t._v("浏览器端")]),t._v("的Javascript模块化")]),t._v(" "),s("li",[t._v("CommonJS 适用于"),s("strong",[t._v("服务器端")]),t._v("的Javascript模块化")])]),t._v(" "),s("p",[t._v("太多的模块化规范给开发者增加了"),s("strong",[t._v("学习的难度")]),t._v("与"),s("strong",[t._v("开发的成本")]),t._v("。因此，"),s("strong",[t._v("大一统的ES6")]),t._v("模块化规范诞生了!")]),t._v(" "),s("h3",{attrs:{id:"_1-2-什么是es6模块化规范"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-什么是es6模块化规范"}},[t._v("#")]),t._v(" 1.2. 什么是ES6模块化规范")]),t._v(" "),s("p",[s("strong",[t._v("ES6模块化规范是浏览器端与服务器端")]),t._v("通用的模块化开发规范。它的出现极大的降低了前端开发者的模块化学习成本，开发者不需再额外学习AMD、CMD或CommonJS等模块化规范。")]),t._v(" "),s("p",[t._v("ES6模块化规范中定义:")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("每个js 文件都是一个独立的模块")])]),t._v(" "),s("li",[s("p",[t._v("导入其它模块成员使用"),s("strong",[t._v("import")]),t._v("关键字")])]),t._v(" "),s("li",[s("p",[t._v("向外共享模块成员使用"),s("strong",[t._v("export")]),t._v("关键字")])])]),t._v(" "),s("h3",{attrs:{id:"_1-3-在node-js中体验es6模块化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-在node-js中体验es6模块化"}},[t._v("#")]),t._v(" 1.3. 在node.js中体验ES6模块化")]),t._v(" "),s("p",[t._v("node.js中"),s("strong",[t._v("默认仅支持CommonJS模块化规范")]),t._v("，若想基于node.js体验与学习ES6的模块化语法，可以按照如下两个步骤进行配置:")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("确保安装了"),s("code",[t._v("v14.15.1")]),t._v("或更高版本的node.js，")])]),t._v(" "),s("li",[s("p",[t._v("在package.json的根节点中添加"),s("code",[t._v('"type": "module"')]),t._v("节点")])])]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("初始化")]),t._v(" "),s("p",[t._v("快速新建package.json文件: 在终端中输入"),s("code",[t._v("npm init -y")])])]),t._v(" "),s("h3",{attrs:{id:"_1-4-es6模块化的基本语法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-es6模块化的基本语法"}},[t._v("#")]),t._v(" 1.4. ES6模块化的基本语法")]),t._v(" "),s("BackTop"),t._v(" "),s("p",[t._v("ES6的模块化主要包含如下3种用法:")]),t._v(" "),s("h4",{attrs:{id:"_1-4-1-默认导出与默认导入"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-1-默认导出与默认导入"}},[t._v("#")]),t._v(" 1.4.1 默认导出与默认导入")]),t._v(" "),s("h4",{attrs:{id:"_1-4-1-1-默认导出"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-1-1-默认导出"}},[t._v("#")]),t._v(" 1.4.1.1 默认导出")]),t._v(" "),s("p",[t._v("语法: "),s("strong",[t._v("export default")]),t._v("默认导出的成员")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//定义模块私有成员n1")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" n1"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//定义模块私有成员n2 (外界访问不到n2，因为它没有被共享出去)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" n2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//定义模块私有方法show")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("show")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//使用export default 默认导出语法，向外共享n1和show 两个成员")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n\tn1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\tshow\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h4",{attrs:{id:"_1-4-1-2-默认导入"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-1-2-默认导入"}},[t._v("#")]),t._v(" 1.4.1.2 默认导入")]),t._v(" "),s("p",[t._v("语法: "),s("strong",[t._v("import 接收名称from '模块标识符'")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//从01_ m1.js模块中导入export default 向外共享的成员")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//并使用m1成员进行接收")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" m1 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./01 m1.js'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//打印输出的结果为:")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// { n1: 10，show: [Function: show] }")]),t._v("\nconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("m1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h4",{attrs:{id:"_1-4-1-3-按需导出与按需导入的注意事项"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-1-3-按需导出与按需导入的注意事项"}},[t._v("#")]),t._v(" 1.4.1.3 按需导出与按需导入的注意事项")]),t._v(" "),s("p",[t._v("每个模块中，"),s("strong",[t._v("只允许使用唯一的一次")]),t._v("export default，否则会报错!")]),t._v(" "),s("h4",{attrs:{id:"_1-4-2-按需导出与按需导入"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-2-按需导出与按需导入"}},[t._v("#")]),t._v(" 1.4.2 按需导出与按需导入")]),t._v(" "),s("h4",{attrs:{id:"_1-4-2-1-按需导出"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-2-1-按需导出"}},[t._v("#")]),t._v(" 1.4.2.1 按需导出")]),t._v(" "),s("p",[t._v("语法: "),s("strong",[t._v("export按需导出的成员")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//当前模块为03_ m2.js")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//向外按需导出变量s1")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" s1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'aaa'")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//向外按需导出变量s2")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" s2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ccc'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//向外按需导出方法say")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("say")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("a")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h4",{attrs:{id:"_1-4-2-2-按需导出"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-2-2-按需导出"}},[t._v("#")]),t._v(" 1.4.2.2 按需导出")]),t._v(" "),s("p",[t._v("语法: "),s("strong",[t._v("import{ s1 } from '模块标识符'")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//导入模块成员")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" info"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("s1，s2 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" str2，say"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./03 m2.js'")]),t._v("\n\nconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("s1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 打印输出aaa")]),t._v("\nconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("s2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 打印输出ccc")]),t._v("\nconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("say"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//打印输出[Function: say]")]),t._v("\n")])])]),s("h4",{attrs:{id:"_1-4-2-3-按需导出与按需导入的注意事项"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-2-3-按需导出与按需导入的注意事项"}},[t._v("#")]),t._v(" 1.4.2.3 按需导出与按需导入的注意事项")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("每个模块中可以使用"),s("strong",[t._v("多次")]),t._v("按需导出")])]),t._v(" "),s("li",[s("p",[t._v("按需"),s("strong",[t._v("导入的成员名称")]),t._v("必须和"),s("strong",[t._v("按需导出的名称")]),t._v("保持一致")])]),t._v(" "),s("li",[s("p",[t._v("按需导入时，可以使用"),s("strong",[t._v("as关键字")]),t._v("进行重命名")])]),t._v(" "),s("li",[s("p",[t._v("按需导入可以和默认导入一起使用")])])]),t._v(" "),s("h4",{attrs:{id:"_1-4-3-直接导入并执行模块中的代码"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-3-直接导入并执行模块中的代码"}},[t._v("#")]),t._v(" 1.4.3 直接导入并执行模块中的代码")]),t._v(" "),s("p",[t._v("如果只想单纯地执行某个模块中的代码，并不需要得到模块中向外共享的成员。此")]),t._v(" "),s("p",[t._v("时，可以直接导入并执行模块代码，示例代码如下:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//当前文件模块为05_ m3.js")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//在当前模块中执行一个for 循环操作")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("leti"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\tconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// -------------------分割线---------------------")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//直接导入并执行模块代码，不需要得到模块向外共享的成员")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./05_ m3.js'")]),t._v("\n")])])]),s("h2",{attrs:{id:"_2-promise"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-promise"}},[t._v("#")]),t._v(" 2. Promise")]),t._v(" "),s("h3",{attrs:{id:"_2-1-回调地狱"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-回调地狱"}},[t._v("#")]),t._v(" 2.1 回调地狱")]),t._v(" "),s("p",[s("strong",[t._v("多层回调函数的相互嵌套")]),t._v("，就形成了"),s("strong",[t._v("回调地狱")]),t._v("。")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//第1层回调函数")]),t._v("\n\tconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'延时1秒后输出'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//第2层回调函数")]),t._v("\n\t\tconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'再延时2秒后输出'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//第3层回调函数")]),t._v("\n\t\t\tconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'再延时3秒后输出'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("，"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("，"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("，"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("回调地狱的缺点")]),t._v(" "),s("ul",[s("li",[t._v("代码耦合性太强，牵一发而动全身，"),s("strong",[t._v("难以维护")])]),t._v(" "),s("li",[t._v("大量冗余的代码相互嵌套，代码的"),s("strong",[t._v("可读性变差")])])])]),t._v(" "),s("h3",{attrs:{id:"_2-2-promise的基本概念"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-promise的基本概念"}},[t._v("#")]),t._v(" 2.2 Promise的基本概念")]),t._v(" "),s("ol",[s("li",[s("p",[s("strong",[t._v("Promise 是一个构造函数")])]),t._v(" "),s("ul",[s("li",[s("p",[t._v("我们可 以创建Promise的实例"),s("code",[t._v("const p = new Promise()")])])]),t._v(" "),s("li",[s("p",[t._v("new 出来的Promise实例对象，"),s("strong",[t._v("代表一个异步操作")])])])])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("Promise.prototype上包含一个.then()方法")])]),t._v(" "),s("ul",[s("li",[s("p",[t._v("每一次 new Promise()构造函数得到的实例对象，")])]),t._v(" "),s("li",[s("p",[t._v("都可以通过"),s("strong",[t._v("原型链")]),t._v("的方式访问到.then() 方法，例如"),s("code",[t._v("p.then()")])])])])]),t._v(" "),s("li",[s("p",[s("strong",[t._v(".then() 方法用来预先指定成功和失败的回调函数")])]),t._v(" "),s("ul",[s("li",[s("p",[t._v("p.then(成功的回调函数，失败的回调函数)")])]),t._v(" "),s("li",[s("p",[t._v("p.then(result=>{}, error=>{})")])]),t._v(" "),s("li",[s("p",[t._v("调用 .then()方法时，"),s("strong",[t._v("成功")]),t._v("的回调函数是"),s("strong",[t._v("必选的")]),t._v("、失败的回调函数是可选的")])])])])]),t._v(" "),s("h3",{attrs:{id:"_2-3-then-fs的基本使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-then-fs的基本使用"}},[t._v("#")]),t._v(" 2.3 then-fs的基本使用")]),t._v(" "),s("p",[t._v("调用then-fs提供的"),s("strong",[t._v("readFile()"),s("strong",[t._v("方法，可以异步地读取文件的内容，它的")]),t._v("返回值是")])]),t._v(" "),s("p",[s("strong",[t._v("Promise的实例对象")]),t._v("。因此"),s("strong",[t._v("可以调用.then() 方法")]),t._v("为每个Promise异步操作指定"),s("strong",[t._v("成")])]),t._v(" "),s("p",[s("strong",[t._v("功和失败")]),t._v("之后的回调函数。示例代码如下:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 基于Promise 的方式读取文件")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" thenFs "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'then-fs'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//注意: .then()中的失败回调是可选的，可以被省略")]),t._v("\nthenFs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./files/1.txt'")]),t._v("，"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'utf8'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("r1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("r1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("，err1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),t._v(" thenFs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./files/2.txt'")]),t._v("，"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'utf8'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("r2")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("r2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("，err2")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(" thenFs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./files/3.txt'")]),t._v("，"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'utf8'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("r3")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("r3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("，err3")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h3",{attrs:{id:"_2-4-基于promise按顺序读取文件的内容"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-基于promise按顺序读取文件的内容"}},[t._v("#")]),t._v(" 2.4 基于Promise按顺序读取文件的内容")]),t._v(" "),s("p",[t._v("Promise支持链式调用从而来解决回调地狱的问题。示例代码如下:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1.返回值是Promise的实例对象")]),t._v("\nthenFs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./files/1.txt'")]),t._v("，"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'utf8'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2.通过.then 为第一个Promise 实例指定成功之后的回调函数")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("r1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n\t\tconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("r1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 3.在第一个.then 中返回一个新的Promise 实例对象")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" thenFs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./files/2.txt'")]),t._v("，"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'utf8'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 4.继续调用.then，为上一个.then的返回值(新的Promise 实例)指定成功之后的回调函数")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("r2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\tconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("og")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("r2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  \t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 5.在第二个.then 中再返回一个新的Promise 实例对象")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" thenFs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("' ./files/3.txt'")]),t._v("，"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'utf8'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 6.继续调用.then，为上一个.then 的返回值(新的Promise 实例)指定成功之后的回调函数")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("r3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n\tconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("r3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h3",{attrs:{id:"_2-5-通过-catch捕获错误"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-通过-catch捕获错误"}},[t._v("#")]),t._v(" 2.5 通过.catch捕获错误")]),t._v(" "),s("p",[t._v("在Promise的链式操作中如果发生了错误，可以使用Promise.prototype**.catch**方法进")]),t._v(" "),s("p",[t._v("行捕获和处理:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("thenFs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./files/11.txt'")]),t._v("，"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'utf8'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("r1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("catch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("err")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h3",{attrs:{id:"_2-6-promise-all-方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-6-promise-all-方法"}},[t._v("#")]),t._v(" 2.6 Promise.all()方法")]),t._v(" "),s("p",[t._v("Promise.all()方法会发起并行的Promise异步操作，等所有的异步操作全部结束后才会")]),t._v(" "),s("p",[t._v("执行下一步的.then操作( 等待机制)。示例代码如下:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1.定义一个数组，存放3个读文件的异步操作")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" promiseArr "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n\tthenFs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./files/11.txt'")]),t._v("，"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'utf8'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\tthenFs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./files/2.txt'")]),t._v("，"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'utf8'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\tthenFs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./files/3.txt'")]),t._v("，"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'utf8'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2.将Promise 的数组，作为Promise.all() 的参数")]),t._v("\nPromise "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("all")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("promiseArr "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//2.1所有文件读取成功(等待机制)")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("r1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("r2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("r3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\tconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("r1，r2，r3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2.2捕获Promise 异步操作中的错误")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("catch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("err")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n\tconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),s("p",[t._v("数组中Promise实例的顺序，就是最终结果的顺序!")])]),t._v(" "),s("h2",{attrs:{id:"_3-async-await"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-async-await"}},[t._v("#")]),t._v(" 3. async / await")]),t._v(" "),s("h3",{attrs:{id:"_3-1-async-await的基本使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-async-await的基本使用"}},[t._v("#")]),t._v(" 3.1 async/await的基本使用")]),t._v(" "),s("p",[t._v("使用async/await简化Promise异步操作的示例代码如下:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" thenFs "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'then-fs'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 按照顺序读取文件1，2，3的内容")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getAllFile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" r1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" thenFs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./files/1.txt'")]),t._v("，"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'utf8'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("r1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" r2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" thenFs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./files/2.txt'")]),t._v("，"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'utf8'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("r2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" r3 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" thenFs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./files/3.txt'")]),t._v("，"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'utf8'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("r3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getAllFile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h3",{attrs:{id:"_3-2-async-await的使用注意事项"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-async-await的使用注意事项"}},[t._v("#")]),t._v(" 3.2 async/await的使用注意事项")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("如果在function中使用了await，则function必须被async修饰")])]),t._v(" "),s("li",[s("p",[t._v("在async方法中，第一个await之前的代码会同步执行，await 之后的代码会异步")])])]),t._v(" "),s("h2",{attrs:{id:"_4-eventloop"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-eventloop"}},[t._v("#")]),t._v(" 4. EventLoop")]),t._v(" "),s("h3",{attrs:{id:"_4-1-同步任务和异步任务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-同步任务和异步任务"}},[t._v("#")]),t._v(" 4.1 同步任务和异步任务")]),t._v(" "),s("p",[t._v("为了防止某个"),s("strong",[t._v("耗时任务")]),t._v("导致"),s("strong",[t._v("程序假死")]),t._v("的问题， JavaScript把待执行的任务分为了两类:")]),t._v(" "),s("ol",[s("li",[s("p",[s("strong",[t._v("同步任务")]),t._v("(synchronous)")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("又叫做"),s("strong",[t._v("非耗时任务")]),t._v("，指的是在主线程.上排队执行的那些任务")])]),t._v(" "),s("li",[s("p",[t._v("只有前一个任务执行完毕,才能执行后一个任务")])])])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("异步任务")]),t._v("( asynchronous )")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("又叫做"),s("strong",[t._v("耗时任务")]),t._v("，异步任务由JavaScript"),s("strong",[t._v("委托给")]),t._v("宿主环境进行执行")])]),t._v(" "),s("li",[s("p",[t._v("当异步任务执行完成后，会"),s("strong",[t._v("通知JavaScript主线程")]),t._v("执行异步任务的"),s("strong",[t._v("回调函数")])])])])])]),t._v(" "),s("h3",{attrs:{id:"_4-2-同步任务和异步任务的执行过程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-同步任务和异步任务的执行过程"}},[t._v("#")]),t._v(" 4.2 同步任务和异步任务的执行过程")]),t._v(" "),s("ol",[s("li",[t._v("同步任务由JavaScript主线程次序执行")]),t._v(" "),s("li",[t._v("异步任务"),s("strong",[t._v("委托给")]),t._v("宿主环境执行")]),t._v(" "),s("li",[t._v("已完成的异步任务"),s("strong",[t._v("对应的回调函数")]),t._v("，会被加入到任务队列中等待执行")]),t._v(" "),s("li",[t._v("JavaScript 主线程的"),s("strong",[t._v("执行栈")]),t._v("被清空后，会读取任务队列中的回调函数，次序执行")]),t._v(" "),s("li",[s("strong",[t._v("JavaScript 主线程不断重复上面的第4步")])])]),t._v(" "),s("h3",{attrs:{id:"_4-3-eventloop的基本概念"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-eventloop的基本概念"}},[t._v("#")]),t._v(" 4.3 EventLoop的基本概念")]),t._v(" "),s("p",[s("strong",[t._v("JavaScript主线程从“任务队列”中读取异步任务的回调函数,放到执行栈中依次执行。")])]),t._v(" "),s("p",[t._v("这个过程是循环不断的，所以整个的这种运行机制又称为"),s("strong",[t._v("EventLoop")]),t._v(" ( 事件循环)。")]),t._v(" "),s("h3",{attrs:{id:"_4-4-宏任务与微任务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-宏任务与微任务"}},[t._v("#")]),t._v(" 4.4 宏任务与微任务")]),t._v(" "),s("h4",{attrs:{id:"_4-4-1-什么是宏任务和微任务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-1-什么是宏任务和微任务"}},[t._v("#")]),t._v(" 4.4.1 什么是宏任务和微任务")]),t._v(" "),s("p",[t._v("JavaScript把异步任务又做了进一步的划分，异步任务又分为两类,分别是:")]),t._v(" "),s("ol",[s("li",[t._v("宏任务(macrotask)\n"),s("ul",[s("li",[t._v("异步 Ajax请求")]),t._v(" "),s("li",[t._v("setTimeout、 setInterval")]),t._v(" "),s("li",[t._v("文件操作")]),t._v(" "),s("li",[t._v("其它宏任务")])])]),t._v(" "),s("li",[t._v("微任务(microtask)\n"),s("ul",[s("li",[t._v("Promise.then、 .catch 和.finally")]),t._v(" "),s("li",[t._v("process.nextTick")]),t._v(" "),s("li",[t._v("其它微任务")])])])]),t._v(" "),s("h4",{attrs:{id:"_4-4-2-宏任务和微任务的执行顺序"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-2-宏任务和微任务的执行顺序"}},[t._v("#")]),t._v(" 4.4.2 宏任务和微任务的执行顺序")]),t._v(" "),s("p",[t._v("每一个宏任务执行完之后，都会检查"),s("strong",[t._v("是否存在待执行的微任务")]),t._v("，如果有，则执行完所有微")]),t._v(" "),s("p",[t._v("任务之后，再继续执行下一个宏任务。")])],1)}),[],!1,null,null,null);s.default=r.exports}}]);